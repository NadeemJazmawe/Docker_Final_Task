pipeline {

  agent any

  environment {
		DOCKERHUB_CREDENTIALS=credentials('dockerhub')
	}

  stages {

    stage('Login to dockerhub') {

			steps {
				sh 'echo $DOCKERHUB_CREDENTIALS_PSW |  docker login -u $DOCKERHUB_CREDENTIALS_USR --password-stdin'
			}
		}

    stage('Build Image') {
      steps {
        sh 'docker build -t bitcoin-price:latest .'
      }
    }

    stage('Push Image') {
      steps {
			sh 'docker push waheeb96/bitcoin-tracker'
        }
      }
    }
  }

  post {
        success {
            slackSend channel: 'jenkins_closing_task', message: 'Build Success'
        }
         
        failure {
            slackSend channel: 'jenkins_closing_task', message: 'Build Failed'
        }
    }
    
}